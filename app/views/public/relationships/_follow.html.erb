<div class="col-md-8 text-light">
  <% if users.exists? %>

    <table class="table text-white text-center">
      <thead>
        <tr>
          <th></th>
          <th>名前</th>
          <th>投稿数</th>
          <th>フォロー </th>
          <th>フォロワー</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% users.each do |user| %>
          <tr class="follow" onclick='window.location="<%= users_show_path(user.id) %>"' role="link">
            <td><%= image_tag user.get_profile_image(30,30), class:"rounded-circle"; %></td>
            <td><%= user.name %></td>
            <td><%= user.post_images.count %></td>
            <td><%= user.followings.count %></td>
            <td><%= user.followers.count %></td>
            <td>
              <% if user != current_user %>
                <% if current_user.following?(user) %>
                  <div class=""><%= link_to "フォロー中", user_relationships_path(user.id), method: :delete, class:"text-light btn btn-outline-success" %></div>
                <% else %>
                  <div class=""><%= link_to "フォローする", user_relationships_path(user.id), method: :post, class:"text-light btn btn-outline-success" %></div>
                <% end %>
              <% end %>
            </td>
            <td>
              <% if user != current_user %>
                <% if current_user.has_room?(user) %>
                  <div><%= link_to "ダイレクトメッセージ", room_path(current_user.get_room(user)), method: :get, class:"text-light btn btn-outline-success" %></div>
                <% else %>
                  <%= form_with model: Room.new, method: :post, local: true do |f|%>
                    <%= f.hidden_field :user_id, value: user.id %>
                    <div><%= f.submit "D Mを始める", class:"text-light btn btn-outline-success" %></div>
                  <% end %>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>ユーザーはいません</p>
  <% end %>
</div>
