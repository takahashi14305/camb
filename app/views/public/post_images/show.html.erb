<%= stylesheet_link_tag "users", :media => "all" %>
<div class="container-fluid">
  <div class="full-page">

    <%= render 'public/homes/header', current_user: current_user %>

    <div class= "row">
      <div class="col-md-3 text-center text-white"></div>
      <div class="col-md-3 text-white mt-1 mb-1">
        <h3>投稿詳細</h3>
      </div>
    </div>

    <div class= "row">
      <div class="col-md-3 text-center text-white" style="margin-top:0px">
        <div>
          <h2>PROFILE</h2>
          <%= link_to users_show_path(@post_image.user.id) do %>
            <div class="text-center" ><%= image_tag @post_image.user.get_profile_image(170,170), class:"border border-3" %></div>
            <h3 class="text-white"><%= @post_image.user.name %></h3>
          <% end %>
          <div>自己紹介</div>
          <% if !@post_image.user.introduction.blank? %>
            <div class= "introduction border-bottom mt-2 ml-4 mr-1"><%= @post_image.user.introduction %></div>
          <% else %>
            <div class= "introduction border-bottom">まだ設定していません</div>
          <% end %>

          <table align="center" width="150" height="180">
            <tr class= "border-bottom">
              <td><%= "投稿数　: #{@post_image.user.post_images.count}" %> 件</td>
            </tr>
            <tr class= "border-bottom">
              <td><%= link_to "Follow　: 　#{@user.followings.count}", user_followings_path(@user.id), class:"text-light" %></td>
            </tr>
            <tr class= "border-bottom">
              <td><%= link_to "Follower　:　#{@user.followers.count}", user_followers_path(@user.id), class:"text-light" %></td>
            </tr>
          </table>

          <% if @post_image.user == current_user %>
            <div class=""><%= link_to "プロフィール編集", edit_user_path(@current_user), class:"text-light btn btn-outline-success mt-4" %></div>
          <% else%>
            <% if current_user.email == 'guest@exp.com' %>
              <div class="btn btn-outline-success text-light mt-4">フォローする</div>
            <% else %>

              <% if current_user.following?(@user) %>
                <div class=""><%= link_to "フォロー中", user_relationships_path(@user.id), method: :delete, class:"text-light btn btn-outline-success mt-4" %></div>
              <% else %>
                <div class=""><%= link_to "フォローする", user_relationships_path(@user.id), method: :post, class:"text-light btn btn-outline-success mt-4" %></div>
              <% end %>
            <% end %>
          <% end %>
          <h5 class="mt-5"><%= flash[:notice] %></h5>


        </div>
      </div>

        <div class="col-md-6">
          <div class="card" style="height: 650px;">
            <div class="images">
              <% @post_image.image.each do |image|%>
                <%= image_tag image, class: 'card-img-top' %>
              <% end %>
            </div>
            <div class="card-body">
              <div class="row" id="post_comment_form_<%= @post_image.id %>">
                <%= render "public/post_comments/post_comments", post_image: @post_image, post_comment: @post_comment %>

              </div>
            </div>
            <h5 class="card-footer">
                <%= image_tag @post_image.user.get_profile_image(30,30), class:"rounded-circle"; %>
                <%= link_to @post_image.user.name, users_show_path(@post_image.id), class:"text-dark" %>
            </h5>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card mb-4 mr-2" style="height: 650px;">
            <div class="card-header">
              <h4 class="card-title"><%= @post_image.title %></h4>
            </div>
            <div class="card-body">
              <blockquote class="blockquote mb-0">
                <div class='box6 scroll'>
                  <p class="card-text"><%= @post_image.body %></p>
                </div>
                <footer class="blockquote-footer">投稿日：<%= @post_image.created_at.strftime('%Y/%m/%d') %></footer>
                <footer class="blockquote-footer">編集日：<%= @post_image.updated_at.strftime('%Y/%m/%d') %></footer>
              </blockquote>
            </div>

            <div class="card-footer">
              <div class="d-flex justify-content-center">

                <div id="favorite_buttons_<%= @post_image.id %>" class="mr-4" >
                  <%= render "public/favorites/favorite", post_image: @post_image %>
                </div>

                <div class="mr-3">
                  <%= link_to "https://twitter.com/share?url=#{ request.url }&text=【#{ @post_image.user.name }の投稿をシェア】%0a%0a#{ @post_image.title }%0a%0a%23CAMB%20%23キャンプ%20%23キャンプライフ%0a気になったら見てね！", target: '_blank' do %>
                    <i class="fab fa-twitter" style='color: #3399FF;'></i>シェア
                  <% end %>
                </div>

                <% if @post_image.user == current_user %>
                  <div class=""><%= link_to "削除", post_image_path(@post_image), method: :delete, "data-confirm" => "本当に削除しますか？", class:"text-danger btn btn-outline-success mr-4" %></div>
                  <div class=""><%= link_to "編集", edit_post_image_path(@post_image.id), class:"text-dark btn btn-outline-success" %></div>
                <% end %>
              </div>
            </div>
          </div>
        </div>

    </div>
  </div>
</div>

